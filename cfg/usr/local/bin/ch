#!/usr/bin/env bash
#
# Clipboard history
set -e

usage() {
  echo "usage: ${0##*/} [-h] [-n NUM] [-l]"
  echo
  echo 'clipboard history'
  echo
  echo 'options:'
  echo '  -h      show this help message and exit'
  echo '  -n NUM  specify a num of the stored item'
  echo '  -l      view the stored clipboard items'

  exit "${1}"
}

main() {
  local OPTARG
  local arg

  # Parse args
  ((${#} == 0)) && usage 1 >&2
  while getopts 'hn:l' arg; do
    case "${arg}" in
      n)
        local num="${OPTARG}"
        local cmd="${arg}"
        ;;
      l) local cmd="${arg}" ;;
      h) usage 0 ;;
      *) usage 1 >&2 ;;
    esac
  done

  case "${cmd}" in
    n) cliphist list | grep -w -m1 "^${num}." | cliphist decode | wl-copy ;;
    l) cliphist list ;;
    *) usage 1 >&2 ;;
  esac
}

main "${@}"
